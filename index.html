<!DOCTYPE html>
<html lang="ja">
<head>
  <title>AR-ZINE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta charset="UTF-8">
  <meta name="description" content="第21回東京大学制作展の作品AR-ZINEが提供する、会場パンフレットと連動して鑑賞いただけるARコンテンツです。">

  <!-- a-frame -->
  <!-- <script src="https://aframe.io/releases/0.9.0/aframe.min.js"></script> -->
  <!-- 8thwall -->
  <script src="//cdn.8thwall.com/web/aframe/8frame-0.9.0.min.js"></script>
  <script async
    src="//apps.8thwall.com/xrweb?appKey=aL1mTuDSbvLIajMavCZnyBmrOeR1EDPZNMiT5vOyRzjHlKcAGczBmNBpbcBNdVNm8qXsX7"></script>
  <script src="//cdn.8thwall.com/web/xrextras/xrextras.js"></script>
  <script defer src="//cdn.8thwall.com/web/aframe/aframe-animation-component-5.1.2.min.js"></script>
  <!-- aframe-extras -->
  <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v4.2.0/dist/aframe-extras.min.js"></script>
  <!-- event.js -->
  <script src="https://rawgit.com/nicolocarpignoli/nicolocarpignoli.github.io/master/ar-click-events/events.js"></script>
  <!-- look-at component -->
  <script src="https://unpkg.com/aframe-look-at-component@0.8.x/dist/aframe-look-at-component.min.js"></script>
  <!-- html-shader and html2canvas -->
  <script src="./script/aframe-html-shader.min.js"></script>
  <script src="./script/html2canvas.min.js"></script>

  <!-- custom scripts -->
  <script src="./script/index.js"></script>
  <script src="./script/load.js"></script>
  <script src="./script/cover.js"></script>
  <script src="./script/map.js"></script>

  <link rel="stylesheet" type="text/css" href="./css/style.css">
  <link href="https://fonts.googleapis.com/css?family=M+PLUS+1p" rel="stylesheet">
</head>

<body>
  <div id="loading" >
    <div id="loading-text">
      <h2>第21回東大制作展</h2> 
      <p>ああ言えばこう言う。こう言えばどう言う？</p>
    </div>
  </div>

  <div id="closebutton" class="close rounded black" style="display: none; z-index: 10">
    <h2></h2>
  </div>

  <a-scene
    xrweb
    xrextras-almost-there
    xrextras-runtime-error
    xrextras-gesture-detector
    close-button
    renderer="gamma-output:true"
    antialias="true"
    gltf-model="dracoDecoderPath: ./script/gltf;">
    <!-- xrextras-tap-recenter -->
    <!-- close-button -->

    <!-- read assets -->
    <a-assets>
      <!-- <a-asset-item id="venueModel" src="./assets/models/map/venue.gltf"></a-asset-item> -->
      <a-asset-item id="venueModel"
        src="https://cdn.glitch.com/ce84335b-cdce-4468-90d9-341ec04d3ba9%2Fvenue.gltf?v=1573030820057"></a-asset-item>
      <a-asset-item id="logotype"
        src="https://cdn.glitch.com/e2d1efa5-515f-4351-8464-aaad485734c5%2Flogotype.gltf?v=1572855739588" shadow>
      </a-asset-item>
      <a-asset-item id="logomark"
        src="https://cdn.glitch.com/e2d1efa5-515f-4351-8464-aaad485734c5%2Flogomark.gltf?v=1572855886654" shadow>
      </a-asset-item>
      <a-asset-item id="facebook"
        src="https://cdn.glitch.com/e2d1efa5-515f-4351-8464-aaad485734c5%2Ffacebook.gltf?v=1572831901994" shadow>
      </a-asset-item>
      <a-asset-item id="instagram"
        src="https://cdn.glitch.com/e2d1efa5-515f-4351-8464-aaad485734c5%2Finstagram.gltf?v=1572831907895" shadow>
      </a-asset-item>
      <a-asset-item id="twitter"
        src="https://cdn.glitch.com/e2d1efa5-515f-4351-8464-aaad485734c5%2Ftwitter.gltf?v=1572831746612" shadow>
      </a-asset-item>
      <a-asset-item id="web" src="https://cdn.glitch.com/e2d1efa5-515f-4351-8464-aaad485734c5%2Fweb.gltf?v=1572930672022"
        shadow></a-asset-item>
      <a-asset-item id="moji" src="https://cdn.glitch.com/e2d1efa5-515f-4351-8464-aaad485734c5%2Ftext.gltf?v=1573259011181"
        shadow></a-asset-item>

      <a-mixin id="sns" animation__mouseenter="property: scale; to: 2.2 2.2 2.2; dur: 200; startEvents: mouseenter"
        animation__mouseleave="property: scale; to: 1.8 1.8 1.8; dur: 200; startEvents: mouseleave"></a-mixin>
      <a-mixin id="appearAnimation"
        animation="property: object3D.position.y; from: -3; to: 0; dur: 3000; easing: easeOutElastic;"
        animation__visible="property: material.opacity; from: 0.0; to: 1.0; dur: 1000" material="transparent: true"></a-mixin>
      <a-mixin id="toggleAnimation" animation="property: visible; from: false; to: true; dur: 1" visible="false"></a-mixin>
    </a-assets>
    <!-- カメラ設定 -->
    <!-- If you use tap action, add rayer-target:mouse to cursor property -->
    <a-entity id="rig" position="0 0 0">
      <a-camera id="camera" look-controls wasd-controls>
        <a-entity cursor="fuse: true; fuse-timeout: 2000" raycaster="objects: .cantap" position="0 0 -1"
          geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03" material="color: #F06666; shader: flat"
          animation__fusing_scale="property: scale; from:1 1 1; to: 0.3 0.3 0.3; startEvents: fusing; dur: 2000 easing:easeOutQuad"
          animation__fusing_color="property: components.material.material.color; type: color; to: #007caa; startEvents: fusing; dur: 1000 easing:easeInOutQuad"
          animation__click="property: scale; from:0.3 0.3 0.3; to: 1 1 1; startEvents: click; dur: 200 easing:easeInQuad"
          animation__mouseleave_scale="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200 easing:easeInQuad"
          animation__mouseleave_color="property: components.material.material.color; type: color; to: #F06666; startEvents: mouseleave; dur: 300">
        </a-entity>
      </a-camera>
    </a-entity>

    <!-- light settings -->
    <a-entity light="type: directional; intensity: 1; castShadow: true;
                   shadowMapHeight: 1024; shadowMapWidth: 1024; shadowCameraTop: 10;" position="0 4.3 -3" shadow>
    </a-entity>
    <a-entity light="type: ambient; intensity: 0.5;"> </a-entity>

    <!-- ロゴの表示 -->
    <a-entity id="cover-scene" show-object="name: cover-jp">
      <!-- ライトの色をアニメーション -->
      <a-light type="point" color="#ff0000" position="0 5 2" animation="property: intensity; from: 0.0; to: 1.0; 
                              dir: alternate; dur: 3000; loop: true; easing: linear;"></a-light>
      <!-- 影を表示する平面 -->
      <a-plane position="0 0 -4" rotation="-90 0 0" width="100" height="100" color="#7BC8A4" shadow shadow-material>
      </a-plane>
      <a-entity id="logo-set" mixin="appearAnimation">
        <a-entity gltf-model="#logomark" scale="5 5 5" position="0 2 -5" rotation="0 -45 0"
          animation__rotation="property: object3D.rotation.y; to: 180; dur: 2000; loop: true; easing: easeInOutQuad;"
          animation__position="property: object3D.position.y; to: 2.2; dir: alternate; dur: 2000; loop: true; easing: easeInOutQuad;"
          scale-on-mouseenter animetion-duration="1500" modify-materials shadow>
        </a-entity>
        <a-entity gltf-model="#logotype" scale="5 5 5" position="0 2 -3" shadow></a-entity>
        <a-entity gltf-model="#web" scale="1.8 1.8 1.8" position="-1.5 0.8 -3" mixin="sns" class="cantap"
          link-with-newwindow="href: http://www.iiiexhibition.com/"></a-entity>
        <a-entity gltf-model="#facebook" scale="1.8 1.8 1.8" position="-0.5 0.8 -3" mixin="sns" class="cantap"
          link-with-newwindow="href: https://www.facebook.com/iiiexhibition/"></a-entity>
        <a-entity gltf-model="#twitter" scale="1.8 1.8 1.8" position="0.5 0.8 -3" mixin="sns" class="cantap"
          link-with-newwindow="href: https://twitter.com/iiiexhibition"></a-entity>
        <a-entity gltf-model="#instagram" scale="1.8 1.8 1.8" position="1.5 0.8 -3" mixin="sns" class="cantap"
          link-with-newwindow="href: https://www.instagram.com/iiiexhibition/?hl=ja"></a-entity>
      </a-entity>
    </a-entity>

    <!-- 地図の表示 -->
    <a-entity id="venue" scale="0.4 0.4 0.4" position="0 -1 -2" rotation="0 30 0" xrextras-one-finger-rotate xrextras-named-image-target="name: map">
      <a-entity gltf-model="#venueModel" scale="0.5 0.5 0.5" position="0 0 -3" shadow play-all-model-animations></a-entity>
      <a-sphere material="color: #FF5721" position="0 0 0" show-detail="imgid: #title1" class="cantap"></a-sphere>
      <a-sphere material="color: #FFFFFF" position="0 0 3" show-detail="imgid: #title1"></a-sphere>
    
      <a-sphere material="color: #FF5721" position="1.45335 5.26132 -4.16738" geometry="" scale="0.1 0.1 0.1"
        show-detail="imgid: #title1"></a-sphere>
      <a-sphere material="color: #FF5721" position="1.45335 5.26132 -4.16738" geometry="" scale="0.1 0.1 0.1"></a-sphere>
      <a-sphere material="color: #FF5721" position="1.44411 5.3111 -3.78809" geometry="" scale="0.1 0.1 0.1"></a-sphere>
      <a-sphere material="color: #FF5721" position="1.06853 5.32919 -3.83261" geometry="" scale="0.1 0.1 0.1"></a-sphere>
      <a-sphere material="color: #FF5721" position="0.70677 5.27943 -3.80035" geometry="" scale="0.1 0.1 0.1"></a-sphere>
      <a-sphere material="color: #FF5721" position="0.7114 5.29184 -4.21623" geometry="" scale="0.1 0.1 0.1"></a-sphere>
      <a-sphere material="color: #FF5721" position="0.71 5.25624 -4.53762" geometry="" scale="0.1 0.1 0.1"></a-sphere>
    
      <a-sphere mixin="sns" material="color: #F06191" scale="0.1 0.1 0.1" position="0 0.17476 -3.00098"
        show-detail="imgid: #title1" class="cantap"></a-sphere>
    </a-entity>

  </a-scene>
</body>
<script>
  var scene = document.querySelector("a-scene");
  var run = function () {
    document.getElementById("loading").classList.add("hidden");
  };
  if (scene.hasLoaded) {
    run();
  } else {
    scene.addEventListener("loaded", run);
  }
</script>
</html>
